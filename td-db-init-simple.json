{
  "family": "db-init-simple",
  "networkMode": "awsvpc",
  "requiresCompatibilities": ["FARGATE"],
  "cpu": "256",
  "memory": "512",
  "executionRoleArn": "arn:aws:iam::852048987212:role/shopease-ecs-execution-role",
  "containerDefinitions": [
    {
      "name": "mysql-client",
      "image": "mysql:8.0",
      "essential": true,
      "command": [
        "sh", "-c",
        "echo '=== Creating ShopEase Database ===' && mysql -hshopease-mysql.cmni2wmcozyh.us-east-1.rds.amazonaws.com -uadmin -pShopEase2025!SecureDB <<EOF\nCREATE DATABASE IF NOT EXISTS shopease_db;\nUSE shopease_db;\n\nCREATE TABLE IF NOT EXISTS products (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  name VARCHAR(200) NOT NULL,\n  description TEXT,\n  price DECIMAL(10,2) NOT NULL,\n  stock INT DEFAULT 0,\n  category VARCHAR(100),\n  image_url VARCHAR(500),\n  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\nCREATE TABLE IF NOT EXISTS users (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  email VARCHAR(200) UNIQUE NOT NULL,\n  password_hash VARCHAR(255) NOT NULL,\n  first_name VARCHAR(100),\n  last_name VARCHAR(100),\n  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\nCREATE TABLE IF NOT EXISTS orders (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  user_id INT NOT NULL,\n  total_amount DECIMAL(10,2) NOT NULL,\n  status VARCHAR(50) DEFAULT 'pending',\n  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n  FOREIGN KEY (user_id) REFERENCES users(id)\n);\n\nCREATE TABLE IF NOT EXISTS payments (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  order_id INT NOT NULL,\n  amount DECIMAL(10,2) NOT NULL,\n  payment_method VARCHAR(50),\n  status VARCHAR(50) DEFAULT 'pending',\n  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n  FOREIGN KEY (order_id) REFERENCES orders(id)\n);\n\nCREATE TABLE IF NOT EXISTS notifications (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  user_id INT NOT NULL,\n  message TEXT NOT NULL,\n  type VARCHAR(50),\n  is_read BOOLEAN DEFAULT FALSE,\n  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n  FOREIGN KEY (user_id) REFERENCES users(id)\n);\n\nSHOW TABLES;\nEOF\necho '=== Database Setup Complete! ==='"
      ],
      "logConfiguration": {
        "logDriver": "awslogs",
        "options": {
          "awslogs-create-group": "true",
          "awslogs-group": "/ecs/shopease",
          "awslogs-region": "us-east-1",
          "awslogs-stream-prefix": "db-init"
        }
      }
    }
  ]
}